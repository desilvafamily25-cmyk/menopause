<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Women's Health Assessment | PauseSleep</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes fade-in {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .animate-fade-in {
            animation: fade-in 0.5s ease-out;
        }
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        .animate-spin {
            animation: spin 1s linear infinite;
        }
        @media print {
            body * {
                visibility: hidden;
            }
            #results-section, #results-section * {
                visibility: visible;
            }
            #results-section {
                position: absolute;
                left: 0;
                top: 0;
            }
        }
        .brand-gradient {
            background: linear-gradient(135deg, #2D3E5F 0%, #4A7C6F 100%);
        }
        .brand-border {
            border-color: #4A7C6F;
        }
    </style>
</head>
<body class="min-h-screen bg-gradient-to-br from-gray-50 to-stone-100 p-4">
    <div class="max-w-4xl mx-auto bg-white rounded-xl shadow-lg overflow-hidden">
        <!-- Header with Branding -->
        <div class="brand-gradient text-white p-8">
            <div class="flex items-center justify-between mb-4">
                <div class="flex items-center gap-4">
                    <div class="bg-white rounded-full p-2 w-20 h-20 flex items-center justify-center">
                        <img src="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 200 200'%3E%3Ccircle cx='100' cy='100' r='100' fill='%232D3E5F'/%3E%3Cpath d='M100 50 Q120 70 100 90 Q80 70 100 50' fill='white'/%3E%3Ctext x='100' y='130' font-family='serif' font-size='24' fill='white' text-anchor='middle' font-weight='bold'%3EPauseSleep%3C/text%3E%3Cpath d='M40 150 Q100 140 160 150' fill='%23B4C9C0' opacity='0.7'/%3E%3Cpath d='M30 165 Q100 155 170 165' fill='%234A7C6F' opacity='0.8'/%3E%3C/svg%3E" alt="PauseSleep Logo" class="w-full h-full object-contain">
                    </div>
                    <div>
                        <h1 class="text-3xl font-bold">Women's Health Assessment</h1>
                        <p class="text-sm text-gray-200 mt-1">Evidence-Based Clinical Decision Support Tool</p>
                    </div>
                </div>
            </div>
            <div class="bg-white bg-opacity-10 backdrop-blur-sm rounded-lg p-4 border border-white border-opacity-20">
                <p class="text-sm leading-relaxed">
                    <span class="font-semibold text-lg">Dr Premila Hewage</span><br>
                    Founder, <a href="https://www.pausesleep.com.au" target="_blank" class="underline hover:text-gray-200 transition-colors">www.PauseSleep.com.au</a><br>
                    <span class="text-xs text-gray-200 mt-1 inline-block">GP-Led • Evidence-Based • Patient-Centred Care</span>
                </p>
            </div>
        </div>

        <!-- Form Content -->
        <div class="p-6">
            <div class="bg-teal-50 border-l-4 border-teal-600 p-4 mb-6 rounded-r-lg">
                <p class="text-sm text-gray-700">
                    <strong class="text-teal-800">Complete this questionnaire</strong> to help us provide safe, personalised care for your menopause and women's health needs.
                </p>
            </div>

            <form id="consultForm" class="space-y-6">
                <!-- Patient Details -->
                <section class="border-l-4 brand-border pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4 flex items-center gap-2">
                        <svg class="w-5 h-5 text-teal-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        Personal Information
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Full Name <span class="text-red-600">*</span></label>
                            <input type="text" id="patientName" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Date of Birth <span class="text-red-600">*</span></label>
                            <input type="date" id="dob" required class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Height (cm)</label>
                            <input type="number" step="0.1" id="height" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Weight (kg)</label>
                            <input type="number" step="0.1" id="weight" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                    </div>
                </section>

                <!-- Reason for Consultation -->
                <section class="border-l-4 border-stone-400 pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Reason for Consultation</h2>
                    <p class="text-sm text-gray-600 mb-3">What brings you here today? (Select all that apply)</p>
                    <div class="grid md:grid-cols-2 gap-3">
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_menopause" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Menopause/Perimenopause symptoms</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_weight" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Weight management</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_contraception" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Contraception advice</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_periods" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Period concerns</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_sexual" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Sexual health concerns</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_bladder" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Bladder problems</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_breast" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Breast concerns</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_mental" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Mental health concerns</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" id="reason_other" class="w-4 h-4 text-teal-600 focus:ring-teal-500">
                            <span class="text-sm">Other</span>
                        </label>
                    </div>
                    <div class="mt-3">
                        <label class="block text-sm font-medium mb-1 text-gray-700">If other, please specify</label>
                        <input type="text" id="otherComplaint" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                    </div>
                </section>

                <!-- Medical History Safety Screening -->
                <section class="border-l-4 brand-border pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Medical History - Safety Screening</h2>
                    <div class="bg-red-50 border-l-4 border-red-500 p-4 mb-4 rounded-r-lg">
                        <p class="text-sm font-semibold text-red-800">⚠️ Important for Treatment Safety</p>
                        <p class="text-xs text-red-700 mt-1">Please check if you have EVER been diagnosed with any of these conditions</p>
                    </div>
                    <div class="grid md:grid-cols-2 gap-3">
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="breastCancer" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Breast cancer</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="bloodClot" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Blood clot (DVT or pulmonary embolism)</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="heartStroke" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Heart attack or stroke</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="liverDisease" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Liver disease</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="endometrialCancer" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Endometrial cancer or hyperplasia</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="ovarianCancer" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Ovarian cancer</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="melanoma" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Melanoma</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="vaginalBleeding" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Current unexplained vaginal bleeding</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="migraines" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Migraines</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="osteoporosis" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Osteoporosis</span>
                        </label>
                        <label class="flex items-center gap-2 cursor-pointer hover:bg-stone-100 p-2 rounded transition-colors">
                            <input type="checkbox" value="thyroid" class="medical-history w-4 h-4 text-teal-600">
                            <span class="text-sm">Thyroid dysfunction</span>
                        </label>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-1 text-gray-700">If checked above, please provide year(s) diagnosed and details</label>
                        <textarea id="medHistoryDetails" rows="2" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-1 text-gray-700">Other significant medical conditions</label>
                        <textarea id="otherConditions" rows="2" placeholder="e.g., diabetes, high blood pressure" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Current Medications <span class="text-red-600">*</span></label>
                            <textarea id="currentMeds" rows="3" placeholder="Include vitamins, supplements, natural therapies" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Allergies</label>
                            <textarea id="allergies" rows="3" placeholder="List any medication or other allergies" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                        </div>
                    </div>
                </section>

                <!-- Menstrual & Reproductive History -->
                <section class="border-l-4 border-stone-400 pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Menstrual & Reproductive History</h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Are you currently having periods?</label>
                            <select id="periodStatus" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="regular">Yes, regular periods</option>
                                <option value="irregular">Yes, irregular periods</option>
                                <option value="stopped">No, periods have stopped</option>
                                <option value="na">Not applicable (hysterectomy/IUD)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">If stopped, when?</label>
                            <input type="text" id="periodsStopped" placeholder="e.g., 2 years ago" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Age of Menarche</label>
                            <input type="number" id="menarche" min="8" max="20" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Last Menstrual Period</label>
                            <input type="date" id="lmp" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">Do you experience any of these? (Check all that apply)</label>
                        <div class="grid md:grid-cols-2 gap-2">
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="bleedingOutside" class="menstrual-concerns w-4 h-4 text-teal-600">
                                <span>Bleeding outside periods</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="painWithSex" class="menstrual-concerns w-4 h-4 text-teal-600">
                                <span>Bleeding/pain with intercourse</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="painful" class="menstrual-concerns w-4 h-4 text-teal-600">
                                <span>Painful periods</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="heavy" class="menstrual-concerns w-4 h-4 text-teal-600">
                                <span>Heavy periods</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="prolonged" class="menstrual-concerns w-4 h-4 text-teal-600">
                                <span>Prolonged periods</span>
                            </label>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-3 gap-4 mt-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Number of pregnancies</label>
                            <input type="number" id="numPregnancies" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Vaginal births</label>
                            <input type="number" id="numVaginal" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Caesarean births</label>
                            <input type="number" id="numCaesarean" min="0" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                    </div>
                </section>

                <!-- Preventative Health Screening -->
                <section class="border-l-4 brand-border pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Preventative Health Screening</h2>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Last Cervical Screening Test (year)</label>
                            <input type="number" id="cervicalYear" min="1990" max="2026" placeholder="YYYY" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Result</label>
                            <select id="cervicalResult" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="normal">Normal</option>
                                <option value="abnormal">Abnormal</option>
                                <option value="notdone">Not done</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Last Mammogram (year)</label>
                            <input type="number" id="mammogramYear" min="1990" max="2026" placeholder="YYYY" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Result</label>
                            <select id="mammogramResult" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="normal">Normal</option>
                                <option value="abnormal">Abnormal</option>
                                <option value="notdone">Not done</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">DEXA/Bone Density Scan (year)</label>
                            <input type="number" id="dexaYear" min="1990" max="2026" placeholder="YYYY" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Result</label>
                            <select id="dexaResult" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="normal">Normal</option>
                                <option value="abnormal">Abnormal</option>
                                <option value="notdone">Not done</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Bowel Cancer Screening (year)</label>
                            <input type="number" id="bowelYear" min="1990" max="2026" placeholder="YYYY" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Result</label>
                            <select id="bowelResult" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="normal">Normal</option>
                                <option value="abnormal">Abnormal</option>
                                <option value="notdone">Not done</option>
                            </select>
                        </div>
                    </div>
                </section>

                <!-- Menopause Symptoms -->
                <section class="border-l-4 brand-border pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Menopause Symptoms</h2>
                    <p class="text-sm text-gray-600 mb-3">Rate the severity of symptoms you're experiencing</p>
                    <div class="overflow-x-auto">
                        <table class="w-full border-collapse border border-gray-300 text-sm">
                            <thead>
                                <tr class="bg-gray-800 text-white">
                                    <th class="border border-gray-300 p-2 text-left">Symptom</th>
                                    <th class="border border-gray-300 p-2 text-center">None</th>
                                    <th class="border border-gray-300 p-2 text-center">Mild</th>
                                    <th class="border border-gray-300 p-2 text-center">Moderate</th>
                                    <th class="border border-gray-300 p-2 text-center">Severe</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr><td class="border border-gray-300 p-2">Hot flushes/night sweats</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_hot" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_hot" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_hot" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_hot" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Irritability</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_irritability" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_irritability" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_irritability" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_irritability" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Low mood/Depression</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_mood" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_mood" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_mood" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_mood" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Anxiety</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_anxiety" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_anxiety" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_anxiety" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_anxiety" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Poor sleep/Insomnia</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_sleep" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_sleep" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_sleep" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_sleep" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Fatigue</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_fatigue" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_fatigue" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_fatigue" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_fatigue" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Reduced sexual desire</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_libido" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_libido" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_libido" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_libido" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Vaginal dryness</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_vaginal" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_vaginal" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_vaginal" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_vaginal" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Painful intercourse</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_dyspareunia" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_dyspareunia" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_dyspareunia" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_dyspareunia" value="severe" class="w-4 h-4"></td></tr>
                                <tr><td class="border border-gray-300 p-2">Joint aches</td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_joints" value="none" checked class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_joints" value="mild" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_joints" value="moderate" class="w-4 h-4"></td><td class="border border-gray-300 p-2 text-center"><input type="radio" name="sym_joints" value="severe" class="w-4 h-4"></td></tr>
                            </tbody>
                        </table>
                    </div>
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-1 text-gray-700">Are you currently taking HRT or menopause medications?</label>
                        <textarea id="hrtDetails" rows="2" placeholder="Please list all HRT medications with doses" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent"></textarea>
                    </div>
                </section>

                <!-- Family History & Lifestyle -->
                <section class="border-l-4 border-stone-400 pl-4 bg-stone-50 p-4 rounded-r-lg">
                    <h2 class="text-xl font-semibold text-gray-800 mb-4">Family History & Lifestyle</h2>
                    <div class="mb-4">
                        <label class="block text-sm font-medium mb-2 text-gray-700">Do any blood relatives have: (Check all that apply)</label>
                        <div class="grid md:grid-cols-2 gap-2">
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="breastCancer" class="family-history w-4 h-4 text-teal-600">
                                <span>Breast cancer</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="ovarianCancer" class="family-history w-4 h-4 text-teal-600">
                                <span>Ovarian cancer</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="heartDisease" class="family-history w-4 h-4 text-teal-600">
                                <span>Heart attack (before age 60)</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="stroke" class="family-history w-4 h-4 text-teal-600">
                                <span>Stroke (before age 60)</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="bloodClots" class="family-history w-4 h-4 text-teal-600">
                                <span>Blood clots</span>
                            </label>
                            <label class="flex items-center gap-2 cursor-pointer text-sm">
                                <input type="checkbox" value="osteoporosis" class="family-history w-4 h-4 text-teal-600">
                                <span>Osteoporosis</span>
                            </label>
                        </div>
                    </div>
                    <div class="grid md:grid-cols-2 gap-4">
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Smoking?</label>
                            <select id="smoking" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="no">No</option>
                                <option value="yes">Yes</option>
                                <option value="former">Former smoker</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Alcohol Intake</label>
                            <select id="alcohol" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="none">None</option>
                                <option value="light">Light (1-7 drinks/week)</option>
                                <option value="moderate">Moderate (8-14 drinks/week)</option>
                                <option value="heavy">Heavy (>14 drinks/week)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">Physical Activity</label>
                            <select id="exercise" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent">
                                <option value="">Select...</option>
                                <option value="sedentary">Sedentary</option>
                                <option value="light">Light (1-2 days/week)</option>
                                <option value="moderate">Moderate (3-4 days/week)</option>
                                <option value="active">Active (5+ days/week)</option>
                            </select>
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1 text-gray-700">BMI (if known)</label>
                            <input type="number" step="0.1" id="bmi" class="w-full border border-gray-300 rounded-lg px-3 py-2 focus:ring-2 focus:ring-teal-500 focus:border-transparent" placeholder="e.g., 24.5">
                        </div>
                    </div>
                </section>

                <!-- Consent and Submit -->
                <div class="bg-gradient-to-br from-stone-50 to-teal-50 border-2 border-teal-200 rounded-lg p-6">
                    <label class="flex items-start gap-3 text-sm text-gray-700 cursor-pointer">
                        <input type="checkbox" id="clinicalConsent" class="mt-1 w-5 h-5 text-teal-600 focus:ring-teal-500 rounded" required>
                        <span class="leading-relaxed">
                            <strong class="text-teal-900">Consent Confirmation:</strong> I consent to this assessment and understand this tool provides decision support only. All clinical decisions remain the responsibility of the treating clinician.
                        </span>
                    </label>
                </div>

                <button type="button" onclick="generateAIResults()" class="w-full brand-gradient text-white py-4 rounded-lg font-semibold hover:shadow-lg transition-all transform hover:scale-[1.01] flex items-center justify-center gap-3">
                    <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/>
                    </svg>
                    Generate Clinical Decision Support Summary
                </button>
            </form>

            <div id="loading" style="display:none;" class="mt-8 text-center">
                <div class="inline-block w-12 h-12 border-4 border-teal-200 border-t-teal-600 rounded-full animate-spin"></div>
                <p class="mt-4 text-gray-600">Generating clinical support summary…</p>
            </div>

            <div id="results-section" style="display:none;" class="mt-8 space-y-6 animate-fade-in"></div>
        </div>

        <!-- Footer -->
        <div class="bg-stone-100 border-t border-stone-200 p-6 text-center text-sm text-gray-600">
            <p>Developed by <strong class="text-teal-800">Dr Premila Hewage</strong> | <a href="https://www.pausesleep.com.au" target="_blank" class="text-teal-700 hover:text-teal-800 underline">www.PauseSleep.com.au</a></p>
            <p class="mt-1 text-xs text-gray-500">Evidence-Based Clinical Decision Support for Women's Health</p>
        </div>
    </div>

    <script>
        function getRadioValue(name) {
            const el = document.querySelector(`input[name="${name}"]:checked`);
            return el ? el.value : "none";
        }

        function getFormData() {
            const medicalHistory = Array.from(document.querySelectorAll('.medical-history:checked')).map(cb => cb.value);
            const menstrualConcerns = Array.from(document.querySelectorAll('.menstrual-concerns:checked')).map(cb => cb.value);
            const familyHistory = Array.from(document.querySelectorAll('.family-history:checked')).map(cb => cb.value);
            
            return {
                patientName: document.getElementById('patientName').value,
                dob: document.getElementById('dob').value,
                height: document.getElementById('height').value,
                weight: document.getElementById('weight').value,
                reasonMenopause: document.getElementById('reason_menopause').checked,
                reasonWeight: document.getElementById('reason_weight').checked,
                reasonContraception: document.getElementById('reason_contraception').checked,
                reasonPeriods: document.getElementById('reason_periods').checked,
                reasonSexual: document.getElementById('reason_sexual').checked,
                reasonBladder: document.getElementById('reason_bladder').checked,
                reasonBreast: document.getElementById('reason_breast').checked,
                reasonMental: document.getElementById('reason_mental').checked,
                reasonOther: document.getElementById('reason_other').checked,
                otherComplaint: document.getElementById('otherComplaint').value,
                medicalHistory: medicalHistory,
                medHistoryDetails: document.getElementById('medHistoryDetails').value,
                otherConditions: document.getElementById('otherConditions').value,
                currentMeds: document.getElementById('currentMeds').value,
                allergies: document.getElementById('allergies').value,
                periodStatus: document.getElementById('periodStatus').value,
                periodsStopped: document.getElementById('periodsStopped').value,
                menarche: document.getElementById('menarche').value,
                lmp: document.getElementById('lmp').value,
                menstrualConcerns: menstrualConcerns,
                numPregnancies: document.getElementById('numPregnancies').value,
                numVaginal: document.getElementById('numVaginal').value,
                numCaesarean: document.getElementById('numCaesarean').value,
                cervicalYear: document.getElementById('cervicalYear').value,
                cervicalResult: document.getElementById('cervicalResult').value,
                mammogramYear: document.getElementById('mammogramYear').value,
                mammogramResult: document.getElementById('mammogramResult').value,
                dexaYear: document.getElementById('dexaYear').value,
                dexaResult: document.getElementById('dexaResult').value,
                bowelYear: document.getElementById('bowelYear').value,
                bowelResult: document.getElementById('bowelResult').value,
                symHot: getRadioValue('sym_hot'),
                symIrritability: getRadioValue('sym_irritability'),
                symMood: getRadioValue('sym_mood'),
                symAnxiety: getRadioValue('sym_anxiety'),
                symSleep: getRadioValue('sym_sleep'),
                symFatigue: getRadioValue('sym_fatigue'),
                symLibido: getRadioValue('sym_libido'),
                symVaginal: getRadioValue('sym_vaginal'),
                symDyspareunia: getRadioValue('sym_dyspareunia'),
                symJoints: getRadioValue('sym_joints'),
                hrtDetails: document.getElementById('hrtDetails').value,
                familyHistory: familyHistory,
                smoking: document.getElementById('smoking').value,
                alcohol: document.getElementById('alcohol').value,
                exercise: document.getElementById('exercise').value,
                bmi: document.getElementById('bmi').value
            };
        }

        function calculateAge(dob) {
            if (!dob) return 0;
            return new Date().getFullYear() - new Date(dob).getFullYear();
        }

        function getPositiveSymptoms(data) {
            const symptoms = [];
            
            if (data.symHot !== 'none') symptoms.push(`Hot flushes/night sweats (${data.symHot})`);
            if (data.symIrritability !== 'none') symptoms.push(`Irritability (${data.symIrritability})`);
            if (data.symMood !== 'none') symptoms.push(`Low mood (${data.symMood})`);
            if (data.symAnxiety !== 'none') symptoms.push(`Anxiety (${data.symAnxiety})`);
            if (data.symSleep !== 'none') symptoms.push(`Sleep issues (${data.symSleep})`);
            if (data.symFatigue !== 'none') symptoms.push(`Fatigue (${data.symFatigue})`);
            if (data.symLibido !== 'none') symptoms.push(`Reduced libido (${data.symLibido})`);
            if (data.symVaginal !== 'none') symptoms.push(`Vaginal dryness (${data.symVaginal})`);
            if (data.symDyspareunia !== 'none') symptoms.push(`Painful intercourse (${data.symDyspareunia})`);
            if (data.symJoints !== 'none') symptoms.push(`Joint aches (${data.symJoints})`);
            
            if (data.menstrualConcerns.length > 0) {
                symptoms.push(`Menstrual concerns: ${data.menstrualConcerns.join(', ')}`);
            }
            
            if (data.otherComplaint) symptoms.push(data.otherComplaint);
            
            return symptoms;
        }

        function getImportantNegatives(data) {
            const negatives = [];
            
            if (data.symHot === 'none') negatives.push('No hot flushes/night sweats');
            if (data.symMood === 'none') negatives.push('No mood disturbance');
            if (data.symVaginal === 'none') negatives.push('No vaginal dryness');
            if (data.symDyspareunia === 'none') negatives.push('No dyspareunia');
            if (data.medicalHistory.length === 0) negatives.push('No significant contraindications');
            
            return negatives;
        }

        function createClinicalSummary(data) {
            const age = calculateAge(data.dob);
            
            const reasonsChecked = [];
            if (data.reasonMenopause) reasonsChecked.push('menopause symptoms');
            if (data.reasonWeight) reasonsChecked.push('weight management');
            if (data.reasonContraception) reasonsChecked.push('contraception');
            if (data.reasonPeriods) reasonsChecked.push('period concerns');
            if (data.reasonSexual) reasonsChecked.push('sexual health');
            if (data.reasonBladder) reasonsChecked.push('bladder problems');
            if (data.reasonBreast) reasonsChecked.push('breast concerns');
            if (data.reasonMental) reasonsChecked.push('mental health');
            if (data.reasonOther) reasonsChecked.push('other');

            const screeningInfo = [];
            if (data.cervicalYear) screeningInfo.push(`Cervical screening: ${data.cervicalYear} (${data.cervicalResult || 'result not specified'})`);
            if (data.mammogramYear) screeningInfo.push(`Mammogram: ${data.mammogramYear} (${data.mammogramResult || 'result not specified'})`);
            if (data.dexaYear) screeningInfo.push(`DEXA scan: ${data.dexaYear} (${data.dexaResult || 'result not specified'})`);
            if (data.bowelYear) screeningInfo.push(`Bowel screening: ${data.bowelYear} (${data.bowelResult || 'result not specified'})`);

            return `
Patient: ${data.patientName}
Age: ${age} years (DOB: ${data.dob})
Height: ${data.height || 'Not specified'} cm, Weight: ${data.weight || 'Not specified'} kg

Reason for Consultation: ${reasonsChecked.join(', ') || 'Not specified'}
${data.otherComplaint ? 'Additional: ' + data.otherComplaint : ''}

Medical History (Safety Screening): ${data.medicalHistory.join(', ') || 'None reported'}
${data.medHistoryDetails ? 'Details: ' + data.medHistoryDetails : ''}
${data.otherConditions ? 'Other conditions: ' + data.otherConditions : ''}

Current Medications: ${data.currentMeds || 'None'}
Allergies: ${data.allergies || 'None'}

Menstrual History:
- Period status: ${data.periodStatus || 'Not specified'}
- Age of menarche: ${data.menarche || 'Not specified'}
- Last period: ${data.lmp || 'Not specified'}
- Concerns: ${data.menstrualConcerns.join(', ') || 'None'}
- Pregnancies: ${data.numPregnancies || '0'} (Vaginal: ${data.numVaginal || '0'}, Caesarean: ${data.numCaesarean || '0'})

Preventative Health Screening:
${screeningInfo.length > 0 ? screeningInfo.join('\n') : '- No screening data provided'}

Menopause Symptoms:
- Hot flushes/night sweats: ${data.symHot}
- Mood/anxiety: ${data.symMood}/${data.symAnxiety}
- Sleep: ${data.symSleep}
- Fatigue: ${data.symFatigue}
- Sexual: libido ${data.symLibido}, vaginal dryness ${data.symVaginal}, dyspareunia ${data.symDyspareunia}
- Joint aches: ${data.symJoints}

Current HRT: ${data.hrtDetails || 'None reported'}

Family History: ${data.familyHistory.join(', ') || 'None reported'}

Lifestyle:
- Smoking: ${data.smoking || 'Not specified'}
- Alcohol: ${data.alcohol || 'Not specified'}
- Exercise: ${data.exercise || 'Not specified'}
- BMI: ${data.bmi || 'Not specified'}
            `.trim();
        }

        async function generateAIResults() {
            const form = document.getElementById('consultForm');
            if (!form.checkValidity()) {
                form.reportValidity();
                return;
            }

            const consentChecked = document.getElementById("clinicalConsent")?.checked;
            if (!consentChecked) {
                alert("Please confirm consent before generating clinical decision support.");
                return;
            }

            const data = getFormData();
            const clinicalSummary = createClinicalSummary(data);

            document.getElementById('loading').style.display = 'block';
            document.getElementById('results-section').style.display = 'none';

            try {
                const prompt = `You are an evidence-based clinical decision support system for Australian menopause care. You MUST follow RACGP (Royal Australian College of General Practitioners), AMS (Australasian Menopause Society), and MBS item 695 guidelines STRICTLY.

CRITICAL INSTRUCTIONS:
1. Base ALL recommendations ONLY on the patient data provided below
2. Do NOT infer, assume, or fabricate any clinical information not explicitly stated
3. If information is missing, state "Further assessment required" - never guess
4. All medication recommendations must align with PBS (Pharmaceutical Benefits Scheme) listings and TGA approvals for menopause
5. Flag absolute and relative contraindications to MHT (Menopausal Hormone Therapy) based on medical history provided
6. Cite specific guideline references where applicable (RACGP, AMS, or MBS 695)

Patient consultation summary:
${clinicalSummary}

Provide a structured clinical decision support summary with the following sections:

## 1. SAFETY ASSESSMENT & CONTRAINDICATIONS
- List ALL absolute contraindications to MHT based on patient's medical history (if none, state "No absolute contraindications identified from provided history")
- List ALL relative contraindications requiring specialist input or caution
- Identify any red flags requiring urgent investigation (unexplained vaginal bleeding, breast lumps, etc.)
- State cardiovascular risk factors present (smoking, age, BMI, family history)

## 2. MENOPAUSE STAGE CLASSIFICATION
Based on menstrual history provided, classify as:
- Perimenopause (irregular periods, within 12 months of LMP)
- Postmenopause (>12 months amenorrhoea)
- Premature ovarian insufficiency (<40 years)
- Early menopause (40-45 years)
- Cannot be determined from provided data (state what additional information is needed)

## 3. INVESTIGATIONS TO CONSIDER
List ONLY investigations indicated by the patient's presentation and history:
- FSH/LH/E2 (only if age <40-45 or diagnosis uncertain)
- Thyroid function (only if symptoms overlap with thyroid dysfunction or thyroid history present)
- Lipid profile (cardiovascular risk assessment, MBS item 66551)
- Glucose/HbA1c (if BMI >25 or family history diabetes)
- Bone density (DEXA) - only if risk factors present: early menopause, prolonged amenorrhoea, low BMI, steroid use, fracture history
- Mammogram (if overdue per BreastScreen Australia guidelines: 50-74 years every 2 years)
- Cervical screening (if overdue per NCSP guidelines)
- State if investigations are for MBS item 695 eligibility or other clinical indication

## 4. EVIDENCE-BASED MANAGEMENT CONSIDERATIONS

### A. MENOPAUSAL HORMONE THERAPY (MHT) - Only if NO absolute contraindications
**Estrogen options (if contraindications absent):**
- Transdermal estradiol (patches/gel) - preferred for lower VTE risk, especially if cardiovascular risk factors
- Oral estradiol (if patient preference and lower cardiovascular risk)
- Specify PBS criteria for subsidised prescribing

**Progestogen requirements (MANDATORY if uterus present):**
- Micronised progesterone (Prometrium) 200mg nocte continuously - preferred for better safety profile
- Levonorgestrel IUD (Mirena) for endometrial protection + contraception if <50 years
- Medroxyprogesterone or norethisterone alternatives (specify indications)

**If uterus absent:** Estrogen-only therapy (no progestogen required)

**GSM (Genitourinary Syndrome of Menopause) specific:**
- Vaginal estrogen (Ovestin cream, Vagifem pessaries) for local symptoms - minimal systemic absorption, safe even with contraindications to systemic MHT

### B. NON-HORMONAL OPTIONS
**For vasomotor symptoms (if MHT contraindicated or patient preference):**
- SSRIs: Paroxetine 7.5mg (only TGA-approved non-hormonal for hot flushes), escitalopram, venlafaxine
- Gabapentin 300-900mg (off-label, evidence-based)
- Clonidine (lesser evidence, consider if others unsuitable)

**Lifestyle interventions (evidence-based):**
- Weight management (if BMI >25)
- Regular exercise (150 min/week moderate intensity - reduces vasomotor symptoms, cardiovascular risk, bone loss)
- Smoking cessation (MANDATORY if smoking - reduces cardiovascular risk, improves MHT safety)
- Calcium 1000-1300mg/day + Vitamin D 1000 IU/day (bone health)
- Limit alcohol to <10 standard drinks/week (NHMRC guidelines)

### C. SYMPTOM-SPECIFIC MANAGEMENT
**For each reported moderate/severe symptom, provide targeted approach:**
- Sleep disturbance: Address night sweats, sleep hygiene, consider CBT-I, avoid sedatives unless severe
- Mood/anxiety: Screen with validated tools (PHQ-9, GAD-7), consider psychology referral, SSRIs if moderate-severe
- GSM (vaginal dryness/dyspareunia): Vaginal estrogen first-line, lubricants, moisturisers
- Reduced libido: Exclude other causes (medications, relationship, mood), address GSM, testosterone NOT PBS-listed for women

## 5. PREVENTATIVE HEALTH & SCREENING
Review screening status against current Australian guidelines:
- Cervical screening: Due if >2 years since last (NCSP guidelines)
- Mammogram: Due if 50-74 years and >2 years since last (BreastScreen Australia)
- Bone density (DEXA): Indicated if risk factors present (list specific factors if present)
- Cardiovascular risk assessment: Indicated if >45 years (earlier if risk factors) - Australian CVD risk calculator
- Bowel screening: Due if 50-74 years and >2 years since last (NBCSP)

## 6. MBS ITEM 695 ELIGIBILITY & REQUIREMENTS
**Current eligibility (if applicable):**
- Patient age/menopause status meets criteria
- Checklist completed fulfils documentation requirements
- Eligible for longer consultation (minimum 20-40 minutes MBS 695)
- Can support case conference or management plan development

## 7. FOLLOW-UP & MONITORING PLAN
- Review in 6-12 weeks if commencing new MHT (dose titration, side effects, symptom control)
- Annual review for established MHT (lowest effective dose principle, ongoing risk-benefit)
- Repeat investigations timing (specify which and when based on initial findings)
- Safety monitoring (breast awareness, report any unusual bleeding, VTE symptoms education)

## 8. PATIENT EDUCATION & RESOURCES (Evidence-based only)
- Jean Hailes for Women's Health (www.jeanhailes.org.au) - Australian evidence-based menopause information
- Australasian Menopause Society (www.menopause.org.au) - patient fact sheets
- HealthDirect menopause information (www.healthdirect.gov.au)
- Discuss risks vs benefits of MHT specific to patient's profile
- VTE warning signs (leg pain, swelling, chest pain, SOB)
- When to seek urgent review (vaginal bleeding if postmenopausal, breast lumps, severe symptoms)

## IMPORTANT LIMITATIONS
- This summary is based ONLY on patient-reported questionnaire data
- Full clinical assessment, physical examination, and investigation results required for final treatment decisions
- All recommendations require clinician review, verification, and individualisation
- Contraindications are based on provided history only - may be incomplete
- No liability accepted - treating clinician retains full responsibility for all clinical decisions

## CLINICIAN NOTES
[Space for clinician to add their own assessment, examination findings, and final management plan]

---
*Generated using evidence-based clinical decision support. Clinician verification mandatory. References: RACGP Red Book (2023), AMS Guidelines (2022), MBS Online, PBS Schedule.*`;

                const response = await fetch("/.netlify/functions/ai-consult", {
                    method: "POST",
                    headers: { "Content-Type": "application/json" },
                    body: JSON.stringify({
                        prompt,
                        consent: true
                    })
                });

                if (!response.ok) {
                    const errText = await response.text();
                    throw new Error(errText || "AI request failed");
                }

                const result = await response.json();
                const aiResponse = result.text || "(No response returned)";

                displayResults(data, aiResponse);

            } catch (error) {
                document.getElementById('loading').style.display = 'none';
                alert('Error generating clinical decision support summary.');
                console.error(error);
            }
        }

        function displayResults(data, aiResponse) {
            document.getElementById('loading').style.display = 'none';
            
            const resultsSection = document.getElementById('results-section');
            resultsSection.style.display = 'block';
            
            const age = calculateAge(data.dob);
            const positiveSymptoms = getPositiveSymptoms(data);
            const importantNegatives = getImportantNegatives(data);
            
            resultsSection.innerHTML = `
                <div class="bg-gradient-to-r from-teal-50 to-stone-50 border-l-4 border-teal-600 p-6 rounded-lg shadow-md">
                    <div class="flex items-center gap-2 mb-3">
                        <svg class="w-6 h-6 text-teal-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                        </svg>
                        <h2 class="text-2xl font-bold text-gray-900">Clinical Decision Support Summary</h2>
                    </div>
                    <p class="text-sm text-teal-800">Generated draft to assist the treating clinician. Final decisions remain clinician-led.</p>
                </div>

                <div class="bg-stone-50 border-l-4 border-stone-500 p-6 rounded-lg">
                    <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <svg class="w-5 h-5 text-gray-700" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/>
                        </svg>
                        Patient Summary
                    </h2>
                    <div class="grid md:grid-cols-2 gap-4 text-gray-800">
                        <div><strong>Patient:</strong> ${data.patientName}</div>
                        <div><strong>Age:</strong> ${age} years</div>
                        <div><strong>DOB:</strong> ${data.dob}</div>
                        <div><strong>BMI:</strong> ${data.bmi || 'Not provided'}</div>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-6 rounded-lg">
                    <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <svg class="w-5 h-5 text-green-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Positive Symptoms (Patient-Reported)
                    </h2>
                    ${positiveSymptoms.length > 0 ? `
                        <ul class="list-disc ml-6 space-y-1 text-gray-800">
                            ${positiveSymptoms.map(s => `<li>${s}</li>`).join('')}
                        </ul>
                    ` : '<p class="text-gray-600 italic">No significant symptoms reported</p>'}
                </div>

                <div class="bg-blue-50 border-l-4 border-blue-500 p-6 rounded-lg">
                    <h2 class="text-xl font-bold text-gray-900 mb-4 flex items-center gap-2">
                        <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"/>
                        </svg>
                        Important Negative Findings
                    </h2>
                    ${importantNegatives.length > 0 ? `
                        <ul class="list-disc ml-6 space-y-1 text-gray-800">
                            ${importantNegatives.map(n => `<li>${n}</li>`).join('')}
                        </ul>
                    ` : '<p class="text-gray-600 italic">No significant negative findings documented</p>'}
                </div>

                <div class="bg-white border-2 border-gray-200 rounded-lg p-6 shadow-sm">
                    <div class="prose max-w-none">
                        ${formatAIResponse(aiResponse)}
                    </div>
                </div>

                <div class="bg-amber-50 border-l-4 border-amber-400 p-6 rounded-lg">
                    <div class="flex items-start gap-3">
                        <svg class="w-6 h-6 text-amber-600 flex-shrink-0 mt-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                        </svg>
                        <div>
                            <h3 class="font-bold text-amber-900 mb-2">Professional Disclaimer</h3>
                            <p class="text-sm text-amber-900">
                                This draft summary is generated using clinical decision-support technology. All content must be reviewed, verified, and applied by the treating clinician in the context of full clinical assessment and current evidence-based guidelines.
                            </p>
                        </div>
                    </div>
                </div>

                <div class="flex gap-4">
                    <button onclick="window.print()" class="flex-1 bg-stone-700 text-white py-3 rounded-lg font-semibold hover:bg-stone-800 transition-all flex items-center justify-center gap-2 shadow-md hover:shadow-lg">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 17h2a2 2 0 002-2v-4a2 2 0 00-2-2H5a2 2 0 00-2 2v4a2 2 0 002 2h2m2 4h6a2 2 0 002-2v-4a2 2 0 00-2-2H9a2 2 0 00-2 2v4a2 2 0 002 2zm8-12V5a2 2 0 00-2-2H9a2 2 0 00-2 2v4h10z"/>
                        </svg>
                        Print Summary
                    </button>
                    <button onclick="copyToClipboard()" class="flex-1 brand-gradient text-white py-3 rounded-lg font-semibold hover:shadow-lg transition-all flex items-center justify-center gap-2">
                        <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z"/>
                        </svg>
                        Copy to Clipboard
                    </button>
                </div>
            `;

            setTimeout(() => {
                resultsSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }

        function formatAIResponse(response) {
            let formatted = response
                .replace(/\*\*\*(.+?)\*\*\*/g, '<strong><em>$1</em></strong>')
                .replace(/\*\*(.+?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.+?)\*/g, '<em>$1</em>')
                .replace(/^### (.+)$/gm, '<h3 class="text-xl font-bold text-gray-900 mt-6 mb-3">$1</h3>')
                .replace(/^## (.+)$/gm, '<h2 class="text-2xl font-bold text-gray-900 mt-8 mb-4">$1</h2>')
                .replace(/^# (.+)$/gm, '<h1 class="text-3xl font-bold text-gray-900 mt-8 mb-4">$1</h1>')
                .replace(/^- (.+)$/gm, '<li class="ml-6">$1</li>')
                .replace(/^\d+\. (.+)$/gm, '<li class="ml-6">$1</li>')
                .replace(/\n\n/g, '</p><p class="mb-3">');
            
            formatted = '<p class="mb-3">' + formatted + '</p>';
            
            formatted = formatted.replace(/(<li class="ml-6">.*?<\/li>\s*)+/g, function(match) {
                return '<ul class="list-disc mb-4 space-y-1">' + match + '</ul>';
            });
            
            return formatted;
        }

        function copyToClipboard() {
            const resultsText = document.getElementById('results-section').innerText;
            navigator.clipboard.writeText(resultsText).then(() => {
                alert('Results copied to clipboard!');
            }).catch(err => {
                console.error('Failed to copy:', err);
            });
        }
    </script>
</body>
</html>